<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel</title>
<style>
body { text-align: center; font-family: "Macondo", cursive; padding: 20px; }
input, button { padding: 10px; margin: 5px; border-radius: 10px; }
.card-container { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-top: 20px; }
.card { padding: 10px; border: 2px solid black; border-radius: 20px; background-color: aliceblue; position: relative; }
.delete-btn { position: absolute; top: 5px; right: 5px; font-size: 12px; padding: 3px 6px; cursor: pointer; border-radius: 5px; background: red; color: white; border: none; }
</style>
</head>
<body>

<h2>Add Lecture</h2>
<input type="text" id="titleInput" placeholder="Lecture Title"><br>
<input type="file" id="audioInput" accept="audio/*"><br>
<button onclick="addLecture()">Add Lecture</button>

<div class="card-container" id="cardContainer"></div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  databaseURL: "https://myrecords-54e3c-default-rtdb.firebaseio.com",
  projectId: "MyRecords",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "XXXX",
  appId: "XXXX"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Add lecture
function addLecture() {
  const title = document.getElementById("titleInput").value.trim();
  const file = document.getElementById("audioInput").files[0];
  if(!title || !file) { alert("Title & Audio required!"); return; }

  const reader = new FileReader();
  reader.onload = function(e) {
    const audioBase64 = e.target.result;
    db.ref("lectures").push({ title, audioBase64 })
      .then(() => {
        alert("Lecture added!");
        document.getElementById("titleInput").value = "";
        document.getElementById("audioInput").value = "";
        loadLectures();
      })
      .catch(err => console.log(err));
  };
  reader.readAsDataURL(file); // تحويل الصوت لـ Base64
}

// Load lectures
function loadLectures() {
  const container = document.getElementById("cardContainer");
  container.innerHTML = "";
  db.ref("lectures").once("value", snapshot => {
    snapshot.forEach(child => {
      const lec = child.val();
      const pushId = child.key;
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <h3>${lec.title}</h3>
        <button class="delete-btn" onclick="deleteLecture('${pushId}')">Delete</button>
      `;
      container.appendChild(card);
    });
  });
}

// Delete lecture
function deleteLecture(pushId) {
  if(confirm("هل انت متأكد من الحذف؟")) {
    db.ref("lectures/" + pushId).remove()
      .then(() => loadLectures())
      .catch(err => console.log(err));
  }
}

window.onload = loadLectures;
</script>

</body>
</html>
